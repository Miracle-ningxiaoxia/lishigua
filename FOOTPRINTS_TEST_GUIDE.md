# 「迹 | Footprints」测试指南

## 🎯 测试清单

### 1. 基础功能测试

#### ✅ 页面访问测试
- [ ] 启动开发服务器 `npm run dev`
- [ ] 访问主页 `http://localhost:3000`
- [ ] 点击「迹 | Footprints」菜单项
- [ ] 页面成功跳转到 `/footprints`
- [ ] 页面标题显示「迹 | Footprints」

#### ✅ 3D 场景渲染测试
- [ ] 地球正确显示（蓝色球体）
- [ ] 大气层效果可见（半透明光晕）
- [ ] 背景星空正确渲染
- [ ] 地球自动缓慢旋转
- [ ] 没有控制台错误

#### ✅ 交互控制测试
- [ ] **旋转**：鼠标左键拖动可以旋转地球
- [ ] **缩放**：滚轮向上/向下可以缩放
- [ ] **最小距离**：放大时不会穿入地球内部
- [ ] **最大距离**：缩小时有最大限制
- [ ] **阻尼效果**：释放鼠标后有平滑减速
- [ ] **禁用平移**：鼠标中键/右键拖动无效

### 2. 性能测试

#### ✅ 帧率测试
在浏览器控制台运行：
```javascript
// 显示 FPS 统计
let lastTime = performance.now();
let frames = 0;
function countFPS() {
  frames++;
  const currentTime = performance.now();
  if (currentTime >= lastTime + 1000) {
    console.log(`FPS: ${frames}`);
    frames = 0;
    lastTime = currentTime;
  }
  requestAnimationFrame(countFPS);
}
countFPS();
```

**期望结果**：
- 桌面设备：稳定 60 FPS
- 移动设备：45-60 FPS

#### ✅ 内存测试
1. 打开 Chrome DevTools → Performance
2. 点击「Record」按钮
3. 旋转和缩放地球 30 秒
4. 停止录制
5. 检查内存使用是否稳定（无内存泄漏）

### 3. 响应式测试

#### ✅ 不同屏幕尺寸
- [ ] **桌面** (1920x1080)：全屏正常显示
- [ ] **笔记本** (1366x768)：布局正常
- [ ] **平板** (768x1024)：触摸控制正常
- [ ] **手机** (375x667)：垂直模式正常

#### ✅ 触摸设备测试
- [ ] 单指拖动旋转
- [ ] 双指捏合缩放
- [ ] 触摸响应流畅

### 4. 浏览器兼容性测试

- [ ] **Chrome**：完全正常
- [ ] **Firefox**：完全正常
- [ ] **Safari**：完全正常
- [ ] **Edge**：完全正常

### 5. 贴图加载测试（可选）

如果你已经放置了贴图文件：

#### ✅ 完整版地球测试
- [ ] 日景贴图正确显示（陆地、海洋）
- [ ] 背光面显示城市灯光
- [ ] 法线贴图增强细节
- [ ] 海洋有镜面反光效果
- [ ] 日夜过渡平滑无硬切

#### ✅ 贴图加载失败测试
1. 临时重命名 `public/textures/earth-day.jpg`
2. 刷新页面
3. 验证：系统自动切换到简化版地球
4. 控制台输出：`🌍 使用简化版地球（未找到贴图文件）`

## 🐛 问题排查

### 问题 1: 页面一片黑

**可能原因**：
- WebGL 未启用
- 显卡驱动问题
- 浏览器不支持

**排查步骤**：
1. 访问 https://get.webgl.org/ 检查 WebGL 支持
2. 打开控制台查看错误信息
3. 尝试更新显卡驱动

### 问题 2: 地球不旋转

**可能原因**：
- JavaScript 错误
- React 渲染问题

**排查步骤**：
1. 打开控制台查看错误
2. 检查 `useFrame` 是否正常调用
3. 验证 `earthRef.current` 是否为 null

### 问题 3: 性能很差

**可能原因**：
- 设备性能不足
- 球体精度过高
- 贴图分辨率过大

**解决方案**：
1. 降低球体精度：
   ```typescript
   <sphereGeometry args={[2, 64, 64]} />
   ```
2. 使用简化版地球
3. 压缩贴图文件

### 问题 4: 控制台错误 "Failed to load texture"

**可能原因**：
- 贴图文件不存在
- 文件名不匹配
- 路径错误

**解决方案**：
1. 检查文件是否存在于 `public/textures/`
2. 确认文件名完全匹配（区分大小写）
3. 尝试使用简化版地球

### 问题 5: 鼠标交互不响应

**可能原因**：
- OrbitControls 配置错误
- CSS 覆盖了 Canvas

**解决方案**：
1. 检查 `pointer-events` CSS 属性
2. 确认 Canvas 正确挂载
3. 验证 OrbitControls 正确初始化

## 📊 性能基准

### 桌面设备 (GTX 1660)
- **FPS**: 60 (稳定)
- **内存**: ~150 MB
- **GPU 占用**: ~20%
- **CPU 占用**: ~5%

### MacBook Pro M1
- **FPS**: 60 (稳定)
- **内存**: ~120 MB
- **GPU 占用**: ~15%
- **CPU 占用**: ~3%

### iPhone 12
- **FPS**: 50-60
- **内存**: ~100 MB
- **电池消耗**: 中等

### Android 中端机型
- **FPS**: 35-45
- **内存**: ~120 MB
- **电池消耗**: 较高（建议使用简化版）

## 🔧 调试工具

### 启用 React Three Fiber DevTools

在 `FootprintsScene.tsx` 中添加：

```typescript
import { Perf } from 'r3f-perf'

// 在 Canvas 内部添加
<Perf position="top-left" />
```

然后安装：
```bash
npm install r3f-perf
```

### 显示帧率

在 Canvas 上添加 `frameloop` 属性：
```typescript
<Canvas frameloop="always">
```

### 查看渲染信息

在控制台运行：
```javascript
console.log(window.__THREE_DEVTOOLS__)
```

## ✅ 测试完成标准

所有以下条件满足即为测试通过：

1. ✅ 页面正常加载，无控制台错误
2. ✅ 地球正确渲染并自动旋转
3. ✅ 鼠标/触摸交互流畅响应
4. ✅ 帧率稳定在 30 FPS 以上
5. ✅ 在不同浏览器上正常运行
6. ✅ 移动设备上可以正常使用
7. ✅ 内存使用稳定，无泄漏

## 📝 测试报告模板

```
测试日期：____________________
测试人员：____________________
设备信息：____________________
浏览器版本：__________________

【基础功能】
□ 页面访问正常
□ 3D 场景渲染正常
□ 交互控制正常

【性能表现】
FPS: ______
内存使用: ______
加载时间: ______

【问题记录】
1. _________________________
2. _________________________
3. _________________________

【总体评价】
□ 优秀  □ 良好  □ 一般  □ 需改进

【备注】
_____________________________
_____________________________
```

## 🎊 开始测试！

按照上述清单逐项测试，记录问题并反馈。祝测试顺利！
